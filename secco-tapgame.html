<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECCO TapBot</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- TON Connect SDK -->
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        .font-inter {
            font-family: 'Inter', sans-serif;
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0,-30px,0);
            }
            70% {
                transform: translate3d(0,-15px,0);
            }
            90% {
                transform: translate3d(0,-4px,0);
            }
        }
        
        .animate-bounce {
            animation: bounce 1s ease-in-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        function MainComponent() {
            const [balance, setBalance] = React.useState(0); // Новый игрок начинает с 0
            const [energy, setEnergy] = React.useState(100); // Полная энергия для нового игрока
            const [level, setLevel] = React.useState(1); // Начальный уровень 1
            const [xp, setXp] = React.useState(0); // Начальный XP 0
            const [maxXp, setMaxXp] = React.useState(5000); // Каждый уровень требует 5000 XP
            const [timeLeft, setTimeLeft] = React.useState(43200); // 12 часов в секундах
            const [tapAnimation, setTapAnimation] = React.useState(false);
            const [currentTab, setCurrentTab] = React.useState("ЗАДАНИЯ");
            const [tonBalance, setTonBalance] = React.useState(0); // Баланс TON
            const [walletConnected, setWalletConnected] = React.useState(false);
            const [tonConnectUI, setTonConnectUI] = React.useState(null);
            const [walletAddress, setWalletAddress] = React.useState("");
            const [showGreeting, setShowGreeting] = React.useState(true); // Показать приветствие
            const [referralStats, setReferralStats] = React.useState({
                invited: 0,
                activated: 0
            });
            
            // Задания для заработка монет
            const [tasks, setTasks] = React.useState([
                {
                    id: 1,
                    title: "Сделайте первый тап",
                    description: "Тапните на кнопку, чтобы заработать первые SECCO",
                    reward: 10,
                    completed: false,
                    progress: 0,
                    maxProgress: 1
                },
                {
                    id: 2,
                    title: "Заработайте 100 SECCO",
                    description: "Накопите 100 токенов SECCO",
                    reward: 50,
                    completed: false,
                    progress: 0,
                    maxProgress: 100
                },
                {
                    id: 3,
                    title: "Пригласите первого друга",
                    description: "Поделитесь реферальной ссылкой и пригласите друга",
                    reward: 100,
                    completed: false,
                    progress: 0,
                    maxProgress: 1
                },
                {
                    id: 4,
                    title: "Достигните 2 уровня",
                    description: "Повысьте уровень, чтобы разблокировать новые функции",
                    reward: 75,
                    completed: false,
                    progress: 0,
                    maxProgress: 1
                }
            ]);

            const [inviteCode] = React.useState("SECCO72E3MW");
            const inviteLink = `https://t.me/secco_bot?start=${inviteCode}`;

            // Инициализация TON Connect
            React.useEffect(() => {
                if (typeof window.TonConnectUI !== 'undefined') {
                    const tonConnectUI = new window.TonConnectUI({
                        manifestUrl: 'https://secco-tapgame.netlify.app/tonconnect-manifest.json', // Обновленный манифест
                        buttonRootId: 'ton-connect'
                    });

                    setTonConnectUI(tonConnectUI);

                    tonConnectUI.onStatusChange(async (wallet) => {
                        if (wallet) {
                            setWalletConnected(true);
                            setWalletAddress(wallet.account.address);
                            
                            // Загружаем данные пользователя с сервера
                            try {
                                const response = await fetch(`https://secco-api.netlify.app/api/user/${wallet.account.address}`);
                                const userData = await response.json();
                                
                                setBalance(userData.balance);
                                setEnergy(userData.energy);
                                setLevel(userData.level);
                                setXp(userData.xp);
                            } catch (error) {
                                console.error('Error loading user data:', error);
                            }
                        } else {
                            setWalletConnected(false);
                            setWalletAddress("");
                            setTonBalance(0);
                        }
                    });
                }
            }, []);

            // Обновление прогресса заданий
            React.useEffect(() => {
                setTasks(prev => prev.map(task => {
                    if (task.id === 1 && balance > 0 && !task.completed) {
                        return { ...task, progress: 1, completed: true };
                    }
                    if (task.id === 2 && !task.completed) {
                        return { ...task, progress: Math.min(balance, task.maxProgress), completed: balance >= 100 };
                    }
                    if (task.id === 4 && level >= 2 && !task.completed) {
                        return { ...task, progress: 1, completed: true };
                    }
                    return task;
                }));
            }, [balance, level]);

            // Таймер восстановления энергии
            React.useEffect(() => {
                const timer = setInterval(() => {
                    setTimeLeft((prev) => (prev > 0 ? prev - 1 : 43200));
                    if (timeLeft === 0) {
                        setEnergy(100);
                    }
                }, 1000);
                return () => clearInterval(timer);
            }, [timeLeft]);

            const formatTime = (seconds) => {
                const hours = Math.floor(seconds / 3600);
                const mins = Math.floor((seconds % 3600) / 60);
                const secs = seconds % 60;
                
                if (hours > 0) {
                    return `${hours}:${mins.toString().padStart(2, "0")}:${secs.toString().padStart(2, "0")}`;
                } else {
                    return `${mins}:${secs.toString().padStart(2, "0")}`;
                }
            };

            const handleTap = () => {
                if (energy > 0) {
                    setBalance((prev) => prev + 1);
                    setEnergy((prev) => Math.max(0, prev - 1));
                    setXp((prev) => prev + 1);

                    // Проверка повышения уровня каждые 5000 XP
                    if (xp + 1 >= maxXp) {
                        setLevel((prev) => prev + 1);
                        setXp(0);
                        setMaxXp(5000); // Следующий уровень также требует 5000 XP
                    }

                    setTapAnimation(true);
                    setTimeout(() => setTapAnimation(false), 500);
                }
            };

            const handleTaskClaim = (taskId) => {
                const task = tasks.find(t => t.id === taskId);
                if (task && task.completed) {
                    setBalance(prev => prev + task.reward);
                    setTasks(prev => prev.map(t => 
                        t.id === taskId ? { ...t, claimed: true } : t
                    ));
                }
            };

            const handleBuyEnergy = async (amount, cost) => {
                if (!walletConnected) {
                    alert("Пожалуйста, сначала подключите кошелек TON!");
                    return;
                }

                try {
                    const confirmed = confirm(`Купить ${amount} энергии за ${cost} TON?`);
                    
                    if (confirmed && tonConnectUI) {
                        // Определяем op code для контракта
                        let opCode;
                        switch (amount) {
                            case 25: opCode = 0x12345601; break;
                            case 50: opCode = 0x12345602; break;
                            case 100: opCode = 0x12345603; break;
                            default: throw new Error("Неверное количество энергии");
                        }

                        // Реальная транзакция через TON Connect
                        const transaction = {
                            validUntil: Date.now() + 5 * 60 * 1000, // 5 минут
                            messages: [
                                {
                                    address: "EQBOxIuUPXHOu1fY0O7uGe9yIIaa0-DRcLIk2qVNa_0tZbFD", // Ваш кошелек (пока демо, после развертывания будет адрес контракта)
                                    amount: (cost * 1000000000).toString(), // Конвертируем TON в nanoTON
                                    payload: btoa(JSON.stringify({
                                        op: opCode,
                                        query_id: Date.now(),
                                        energy_amount: amount,
                                        game: "SECCO_ENERGY_PURCHASE"
                                    }))
                                }
                            ]
                        };

                        const result = await tonConnectUI.sendTransaction(transaction);
                        
                        // Валидируем транзакцию на сервере
                        const validationResponse = await fetch('https://secco-api.netlify.app/api/validate-energy-purchase', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                txHash: result.boc,
                                walletAddress: walletAddress,
                                energyAmount: amount,
                                tonAmount: cost
                            })
                        });

                        const validation = await validationResponse.json();
                        
                        if (validation.success) {
                            setEnergy(validation.newEnergy);
                            alert(`Успешно куплено ${amount} энергии!`);
                        } else {
                            alert("Ошибка валидации транзакции: " + validation.error);
                        }
                    } else if (confirmed) {
                        // Fallback для демонстрации
                        alert("Обработка транзакции...");
                        
                        setTimeout(() => {
                            setEnergy(prev => Math.min(100, prev + amount));
                            alert(`Успешно куплено ${amount} энергии!`);
                        }, 2000);
                    }
                } catch (error) {
                    console.error("Ошибка транзакции:", error);
                    alert("Ошибка транзакции: " + error.message);
                }
            };

            const handleInvite = () => {
                navigator.clipboard
                    ?.writeText(inviteLink)
                    .then(() => alert(`Реферальная ссылка скопирована!\n${inviteLink}`))
                    .catch(() => alert(`Ваша реферальная ссылка:\n${inviteLink}`));
            };

            const handleConnectWallet = async () => {
                try {
                    if (tonConnectUI) {
                        // Используем TON Connect UI
                        await tonConnectUI.connectWallet();
                    } else {
                        // Fallback для демонстрации
                        setWalletConnected(true);
                        setTonBalance(10);
                        setWalletAddress("UQD_fake_address_for_demo");
                        alert("Кошелек TON успешно подключен!\nВы получили 10 TON для тестирования.");
                    }
                } catch (error) {
                    alert("Не удалось подключить кошелек: " + error.message);
                }
            };

            const renderTabContent = () => {
                switch (currentTab) {
                    case "ЗАДАНИЯ":
                        return React.createElement("div", { className: "px-6 py-4" },
                            React.createElement("h2", { className: "text-2xl font-bold text-gray-800 mb-6" }, "Задания"),
                            React.createElement("div", { className: "space-y-4" },
                                tasks.map((task) =>
                                    React.createElement("div", {
                                        key: task.id,
                                        className: "bg-white rounded-2xl p-4 shadow-lg"
                                    },
                                        React.createElement("div", { className: "flex justify-between items-start mb-3" },
                                            React.createElement("div", { className: "flex-1" },
                                                React.createElement("h3", { className: "font-bold text-gray-800 mb-1" }, task.title),
                                                React.createElement("p", { className: "text-sm text-gray-600 mb-2" }, task.description),
                                                React.createElement("div", { className: "flex items-center space-x-2" },
                                                    React.createElement("span", { className: "text-xs text-gray-500" }, 
                                                        `${task.progress}/${task.maxProgress}`
                                                    ),
                                                    React.createElement("div", { className: "flex-1 bg-gray-200 rounded-full h-1" },
                                                        React.createElement("div", {
                                                            className: "bg-gradient-to-r from-teal-400 to-teal-500 h-1 rounded-full transition-all duration-300",
                                                            style: { width: `${(task.progress / task.maxProgress) * 100}%` }
                                                        })
                                                    )
                                                )
                                            ),
                                            React.createElement("div", { className: "text-right" },
                                                React.createElement("span", { className: "text-teal-600 font-bold text-sm" }, `+${task.reward}`),
                                                React.createElement("br"),
                                                React.createElement("button", {
                                                    onClick: () => handleTaskClaim(task.id),
                                                    disabled: !task.completed || task.claimed,
                                                    className: `px-3 py-1 rounded-lg text-xs font-bold mt-1 ${
                                                        task.claimed 
                                                            ? "bg-green-500 text-white" 
                                                            : task.completed
                                                                ? "bg-teal-500 text-white hover:bg-teal-600"
                                                                : "bg-gray-300 text-gray-500"
                                                    }`
                                                }, task.claimed ? "ПОЛУЧЕНО" : task.completed ? "ПОЛУЧИТЬ" : "ОЖИДАНИЕ")
                                            )
                                        )
                                    )
                                )
                            )
                        );

                    case "УСИЛЕНИЕ":
                        return React.createElement("div", { className: "px-6 py-4" },
                            React.createElement("h2", { className: "text-2xl font-bold text-gray-800 mb-6" }, "Усиление энергии"),
                            React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg mb-6" },
                                React.createElement("div", { className: "text-center mb-4" },
                                    React.createElement("div", { className: "text-lg font-bold text-gray-800" }, "Баланс TON"),
                                    React.createElement("div", { className: "text-2xl font-bold text-blue-600" }, `${tonBalance.toFixed(2)} TON`),
                                    walletConnected && React.createElement("div", { className: "text-xs text-gray-500 mt-1 break-all" }, 
                                        `Адрес: ${walletAddress.slice(0, 6)}...${walletAddress.slice(-6)}`
                                    )
                                ),
                                !walletConnected && React.createElement("button", {
                                    onClick: handleConnectWallet,
                                    className: "w-full bg-blue-500 text-white py-3 rounded-xl font-bold hover:bg-blue-600 mb-4"
                                }, "Подключить кошелек TON")
                            ),
                            React.createElement("div", { className: "space-y-4" },
                                React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg" },
                                    React.createElement("div", { className: "flex justify-between items-center" },
                                        React.createElement("div", {},
                                            React.createElement("h3", { className: "font-bold text-gray-800" }, "+25 Энергии"),
                                            React.createElement("p", { className: "text-sm text-gray-600" }, "Мгновенно восстановить 25 единиц энергии")
                                        ),
                                        React.createElement("button", {
                                            onClick: () => handleBuyEnergy(25, 0.5),
                                            disabled: tonBalance < 0.5,
                                            className: `px-4 py-2 rounded-lg font-bold ${
                                                tonBalance >= 0.5
                                                    ? "bg-blue-500 text-white hover:bg-blue-600"
                                                    : "bg-gray-300 text-gray-500"
                                            }`
                                        }, "0.5 TON")
                                    )
                                ),
                                React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg" },
                                    React.createElement("div", { className: "flex justify-between items-center" },
                                        React.createElement("div", {},
                                            React.createElement("h3", { className: "font-bold text-gray-800" }, "+50 Энергии"),
                                            React.createElement("p", { className: "text-sm text-gray-600" }, "Мгновенно восстановить 50 единиц энергии")
                                        ),
                                        React.createElement("button", {
                                            onClick: () => handleBuyEnergy(50, 1.0),
                                            disabled: tonBalance < 1.0,
                                            className: `px-4 py-2 rounded-lg font-bold ${
                                                tonBalance >= 1.0
                                                    ? "bg-blue-500 text-white hover:bg-blue-600"
                                                    : "bg-gray-300 text-gray-500"
                                            }`
                                        }, "1.0 TON")
                                    )
                                ),
                                React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg" },
                                    React.createElement("div", { className: "flex justify-between items-center" },
                                        React.createElement("div", {},
                                            React.createElement("h3", { className: "font-bold text-gray-800" }, "Полная энергия"),
                                            React.createElement("p", { className: "text-sm text-gray-600" }, "Восстановить энергию до 100%")
                                        ),
                                        React.createElement("button", {
                                            onClick: () => handleBuyEnergy(100, 2.0),
                                            disabled: tonBalance < 2.0,
                                            className: `px-4 py-2 rounded-lg font-bold ${
                                                tonBalance >= 2.0
                                                    ? "bg-blue-500 text-white hover:bg-blue-600"
                                                    : "bg-gray-300 text-gray-500"
                                            }`
                                        }, "2.0 TON")
                                    )
                                )
                            )
                        );

                    case "ДРУЗЬЯ":
                        return React.createElement("div", { className: "px-6 py-4" },
                            React.createElement("h2", { className: "text-2xl font-bold text-gray-800 mb-6" }, "Пригласить друзей"),
                            React.createElement("div", { className: "bg-white rounded-2xl p-6 shadow-lg mb-6" },
                                React.createElement("div", { className: "text-center mb-4" },
                                    React.createElement("h3", { className: "text-lg font-bold text-gray-800 mb-2" }, "Статистика рефералов"),
                                    React.createElement("div", { className: "grid grid-cols-2 gap-4" },
                                        React.createElement("div", { className: "text-center" },
                                            React.createElement("div", { className: "text-2xl font-bold text-teal-600" }, referralStats.invited),
                                            React.createElement("div", { className: "text-sm text-gray-600" }, "Приглашено")
                                        ),
                                        React.createElement("div", { className: "text-center" },
                                            React.createElement("div", { className: "text-2xl font-bold text-green-600" }, referralStats.activated),
                                            React.createElement("div", { className: "text-sm text-gray-600" }, "Начали играть")
                                        )
                                    )
                                )
                            ),
                            React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg mb-4" },
                                React.createElement("h3", { className: "font-bold text-gray-800 mb-2" }, "Ваша реферальная ссылка"),
                                React.createElement("div", { className: "bg-gray-100 p-3 rounded-lg mb-3 text-sm break-all" }, inviteLink),
                                React.createElement("button", {
                                    onClick: handleInvite,
                                    className: "w-full bg-teal-500 text-white py-3 rounded-xl font-bold hover:bg-teal-600"
                                }, "📋 Скопировать реферальную ссылку")
                            ),
                            React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg" },
                                React.createElement("h3", { className: "font-bold text-gray-800 mb-2" }, "Награды за рефералов"),
                                React.createElement("ul", { className: "space-y-2 text-sm text-gray-600" },
                                    React.createElement("li", {}, "• Пригласите друга: +100 SECCO"),
                                    React.createElement("li", {}, "• Друг достигает 2 уровня: +50 SECCO"),
                                    React.createElement("li", {}, "• Друг зарабатывает 1000 SECCO: +200 SECCO")
                                )
                            )
                        );

                    case "АИРДРОП":
                        return React.createElement("div", { className: "px-6 py-4" },
                            React.createElement("h2", { className: "text-2xl font-bold text-gray-800 mb-6" }, "Аирдроп"),
                            React.createElement("div", { className: "bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-6 shadow-lg mb-6 text-white" },
                                React.createElement("div", { className: "text-center" },
                                    React.createElement("h3", { className: "text-xl font-bold mb-2" }, "🎁 Аирдроп SECCO"),
                                    React.createElement("p", { className: "text-sm opacity-90 mb-4" }, "Подключите ваш кошелек TON для участия в предстоящем аирдропе токенов SECCO!")
                                )
                            ),
                            React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg mb-4" },
                                React.createElement("h3", { className: "font-bold text-gray-800 mb-3" }, "Подключение кошелька"),
                                walletConnected 
                                    ? React.createElement("div", { className: "text-center" },
                                        React.createElement("div", { className: "text-green-600 font-bold mb-2" }, "✅ Кошелек TON подключен"),
                                        React.createElement("div", { className: "text-sm text-gray-600" }, "Вы имеете право на аирдроп!")
                                    )
                                    : React.createElement("div", {},
                                        React.createElement("p", { className: "text-sm text-gray-600 mb-3" }, "Подключите ваш кошелек TON, чтобы стать участником аирдропа SECCO"),
                                        React.createElement("button", {
                                            onClick: handleConnectWallet,
                                            className: "w-full bg-blue-500 text-white py-3 rounded-xl font-bold hover:bg-blue-600"
                                        }, "🔗 Подключить кошелек TON")
                                    )
                            ),
                            React.createElement("div", { className: "bg-white rounded-2xl p-4 shadow-lg" },
                                React.createElement("h3", { className: "font-bold text-gray-800 mb-3" }, "Информация об аирдропе"),
                                React.createElement("div", { className: "space-y-3 text-sm" },
                                    React.createElement("div", { className: "flex justify-between" },
                                        React.createElement("span", { className: "text-gray-600" }, "Общий пул аирдропа:"),
                                        React.createElement("span", { className: "font-bold" }, "10,000,000 SECCO")
                                    ),
                                    React.createElement("div", { className: "flex justify-between" },
                                        React.createElement("span", { className: "text-gray-600" }, "Ваш текущий баланс:"),
                                        React.createElement("span", { className: "font-bold text-teal-600" }, `${balance.toLocaleString()} SECCO`)
                                    ),
                                    React.createElement("div", { className: "flex justify-between" },
                                        React.createElement("span", { className: "text-gray-600" }, "Дата аирдропа:"),
                                        React.createElement("span", { className: "font-bold" }, "Будет объявлена")
                                    ),
                                    React.createElement("hr", { className: "my-3" }),
                                    React.createElement("p", { className: "text-xs text-gray-500" }, 
                                        "Распределение аирдропа будет основано на вашей игровой активности, рефералах и балансе SECCO на момент снапшота."
                                    )
                                )
                            )
                        );

                    default:
                        return React.createElement("div", {}, "Loading...");
                }
            };

            return (
                <div
                    className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 font-inter"
                    style={{
                        width: "100%",
                        maxWidth: "390px",
                        height: "100vh",
                        margin: "0 auto",
                        position: "relative",
                        overflow: "hidden",
                    }}
                >
                    {/* Greeting Modal */}
                    {showGreeting && (
                        <div className="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-3xl p-8 mx-6 text-center shadow-2xl">
                                <div className="text-6xl mb-4">👋</div>
                                <h2 className="text-2xl font-bold text-gray-800 mb-3">Привет!</h2>
                                <p className="text-gray-600 mb-6 leading-relaxed">
                                    Добро пожаловать в SECCO Tap Game!<br/>
                                    Тапайте, зарабатывайте и побеждайте вместе с нами.
                                </p>
                                <button
                                    onClick={() => setShowGreeting(false)}
                                    className="bg-gradient-to-r from-blue-500 to-teal-500 text-white px-8 py-3 rounded-xl font-bold hover:from-blue-600 hover:to-teal-600 transition-all duration-200"
                                >
                                    Начать игру 🎮
                                </button>
                            </div>
                        </div>
                    )}
                    {/* Top Section */}
                    <div className="flex justify-between items-center p-6 pt-16">
                        <div className="flex items-center space-x-3">
                            <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center relative">
                                <span className="text-white font-bold text-lg">$</span>
                                <div className="absolute inset-0 rounded-full border-2 border-blue-300 opacity-50"></div>
                                <div className="absolute -inset-2 rounded-full border border-blue-200 opacity-30"></div>
                            </div>
                            <span className="text-2xl font-bold text-gray-800">SECCO</span>
                        </div>

                        <div className="bg-white rounded-full px-4 py-2 flex items-center space-x-2 shadow-lg">
                            <div className="w-8 h-8 bg-gradient-to-br from-teal-400 to-teal-500 rounded-full flex items-center justify-center">
                                <span className="text-white text-sm font-bold">{level}</span>
                            </div>
                            <div>
                                <div className="text-sm font-bold text-gray-800">Уровень {level}</div>
                                <div className="text-xs text-gray-500">
                                    {xp.toLocaleString()} / {maxXp.toLocaleString()}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Balance Section */}
                    <div className="text-center mt-8 mb-12">
                        <div className="flex items-center justify-center space-x-3">
                            <span className="text-6xl font-bold text-gray-800">
                                {balance.toLocaleString()}
                            </span>
                            <div className="w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-full flex items-center justify-center">
                                <span className="text-white text-xl font-bold">$</span>
                            </div>
                        </div>
                    </div>

                    {/* Tap Area with Energy */}
                    <div className="flex justify-center items-center mb-12 px-6">
                        <div className="relative">
                            <button
                                onClick={handleTap}
                                className={`w-40 h-40 bg-white rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer ${tapAnimation ? "scale-110" : "scale-100"} hover:scale-105 ${energy === 0 ? "opacity-50" : ""}`}
                                style={{
                                    boxShadow: "0 20px 40px rgba(0,0,0,0.1), inset 0 2px 8px rgba(255,255,255,0.8)"
                                }}
                            >
                                <div className="w-20 h-12 bg-gradient-to-br from-teal-400 to-teal-600 rounded-lg flex items-center justify-center transform -rotate-12 pointer-events-none">
                                    <span className="text-white text-2xl font-bold">$</span>
                                </div>
                            </button>

                            <div className="absolute inset-0 w-40 h-40 rounded-full border-4 border-blue-200 opacity-50 pointer-events-none"></div>

                            {tapAnimation && (
                                <div className="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-8 text-teal-500 font-bold animate-bounce pointer-events-none">
                                    +1 SECCO
                                </div>
                            )}
                        </div>

                        <div className="ml-8">
                            <div className="text-right mb-2">
                                <div className="text-lg font-bold text-gray-800">ЭНЕРГИЯ</div>
                                <div className="text-2xl font-bold text-gray-800">
                                    {energy} / 100
                                </div>
                            </div>
                            <div className="w-32 bg-gray-200 rounded-full h-2 mb-2">
                                <div
                                    className="bg-gradient-to-r from-teal-400 to-teal-500 h-2 rounded-full transition-all duration-300"
                                    style={{ width: `${energy}%` }}
                                ></div>
                            </div>
                            <div className="text-sm text-gray-600 text-right">
                                Восстановление: {formatTime(timeLeft)}
                            </div>
                        </div>
                    </div>

                    {/* Dynamic Content */}
                    <div
                        className="flex-1 overflow-y-auto"
                        style={{ height: "calc(100% - 400px)" }}
                    >
                        {renderTabContent()}
                    </div>

                    {/* Bottom Navigation */}
                    <div className="absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl px-4 py-3 shadow-2xl">
                        <div className="flex justify-around items-center">
                            {[
                                { icon: "✅", label: "ЗАДАНИЯ" },
                                { icon: "🚀", label: "УСИЛЕНИЕ" },
                                { icon: "👥", label: "ДРУЗЬЯ" },
                                { icon: "🎁", label: "АИРДРОП" },
                            ].map((tab, index) => (
                                React.createElement("button", {
                                    key: index,
                                    onClick: () => setCurrentTab(tab.label),
                                    className: `flex flex-col items-center py-2 px-3 transition-all duration-200 ${
                                        currentTab === tab.label ? "text-blue-600" : "text-gray-400"
                                    }`
                                },
                                    React.createElement("div", {
                                        className: `w-8 h-8 rounded-lg flex items-center justify-center mb-1 ${
                                            currentTab === tab.label
                                                ? "bg-blue-600 text-white"
                                                : "bg-transparent"
                                        }`
                                    },
                                        React.createElement("span", { className: "text-lg" }, tab.icon)
                                    ),
                                    React.createElement("span", { className: "text-xs font-medium" }, tab.label)
                                )
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(React.createElement(MainComponent), document.getElementById('root'));
    </script>
</body>
</html>
